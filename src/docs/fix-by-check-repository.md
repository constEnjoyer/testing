# –ê–Ω–∞–ª–∏–∑ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ —Å–±–æ—Ä–∫–∏ X10

## 1. –¢–µ–∫—É—â–∏–µ –æ—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏

### 1.1 ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: React Hooks –≤ X10RoomContext.tsx
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:
  1. useEffect –¥–ª—è –∑–≤—É–∫–æ–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤: –¥–æ–±–∞–≤–ª–µ–Ω state.gameState –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
  2. useEffect –¥–ª—è WebSocket: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ socket?.socket
  3. useCallback –¥–ª—è joinGame –∏ completeGame: –¥–æ–±–∞–≤–ª–µ–Ω socket –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### 1.2 ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ x10Utils.ts
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–æ–≤ –∏–∑ X10_CONFIG
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã PRIZE_DISTRIBUTION
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è Response
- –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1.3 ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ cancel/route.ts
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å createSuccessResponse
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è NextResponse
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏–∑ X10_CONFIG

### 1.4 ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –û—à–∏–±–∫–∞ —Å MAX –≤ —Å–±–æ—Ä–∫–µ
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `TypeError: Cannot read properties of undefined (reading 'MAX')`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤ X10_CONFIG:
  ```typescript
  // –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  PLAYERS: {
    MIN: 10,
    MAX: 10
  }
  ```
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ maxReconnectAttempts –≤ Socket.IO –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
  ```typescript
  const CACHED_SOCKET_CONFIG = {
    ...SOCKET_CONFIG,
    maxReconnectAttempts: 3, // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    reconnectDelay: X10_CONFIG.RECONNECT_DELAY
  };
  ```

### 1.5 ‚ö†Ô∏è –ù–æ–≤—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è MongoDB
```
[MONGOOSE] Warning: Duplicate schema index on {"createdAt":1} found
[MONGOOSE] Warning: Duplicate schema index on {"expiresAt":1} found
```
–¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ —Å—Ö–µ–º–∞—Ö:
1. –ò–Ω–¥–µ–∫—Å `createdAt`
2. –ò–Ω–¥–µ–∫—Å `expiresAt`

## 2. –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è MongoDB

### 2.1 –ê–Ω–∞–ª–∏–∑ —Å—Ö–µ–º
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—Ö–µ–º—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∏–Ω–¥–µ–∫—Å–æ–≤
- –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø–æ–ª—è:
  - createdAt
  - expiresAt
  - –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã

### 2.2 –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
1. src/models/User.js
2. src/models/WaitingPlayerX10.js
3. src/models/MatchX10.js
4. src/models/Referral.js

### 2.3 –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
1. –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∏–Ω–¥–µ–∫—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å TTL –∏–Ω–¥–µ–∫—Å—ã
4. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å—Ö–µ–º

## 3. –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏

### ‚úÖ –£—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. –í—Å–µ –æ—à–∏–±–∫–∏ TypeScript
2. –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
4. React Hook –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
5. –û—à–∏–±–∫–∞ —Å MAX –≤ —Å–±–æ—Ä–∫–µ

### üìä –ú–µ—Ç—Ä–∏–∫–∏ —Å–±–æ—Ä–∫–∏:
- –†–∞–∑–º–µ—Ä First Load JS: 87.9 kB
- –£—Å–ø–µ—à–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ API –º–∞—Ä—à—Ä—É—Ç–æ–≤

### üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è MongoDB
2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ production
4. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## 4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ MongoDB

### 4.1 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
```javascript
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ
schema.index({ createdAt: 1 });

// –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
schema.index({ createdAt: 1 });
schema.set('timestamps', true); // –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–π –∏–Ω–¥–µ–∫—Å
```

### 4.2 TTL –∏–Ω–¥–µ–∫—Å—ã
```javascript
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ
schema.index({ expiresAt: 1 }, { expireAfterSeconds: 0 });

// –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
schema.index({ expiresAt: 1 });
schema.index({ expiresAt: 1 }, { expires: '24h' });
```

### 4.3 –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
```javascript
// –ü—Ä–∞–≤–∏–ª—å–Ω–æ
schema.index({ telegramId: 1, createdAt: 1 });

// –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
schema.index({ telegramId: 1 });
schema.index({ createdAt: 1 });
```

## 5. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

üéâ **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!** 
- –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- –û—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è MongoDB

üí™ **–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π MongoDB
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º –∏ –∏–Ω–¥–µ–∫—Å–æ–≤
- –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö 